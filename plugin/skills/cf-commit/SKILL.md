---
name: cf-commit
description: Smart conventional commit with diff analysis
disable-model-invocation: true
model: haiku
tools: [Bash, Read, Glob]
---

# /cf-commit

Create a commit for the current changes. Hint: **$ARGUMENTS**

## Workflow

### Step 1: Analyze Changes
```bash
git status
git diff
git diff --staged
git log --oneline -5
```

### Step 2: Identify Conversation-Related Changes
Review the current conversation to understand what task was performed and which files were modified as part of that task.

- **Prioritize changes from the current conversation** — files you edited or created during this session are the primary candidates for this commit
- **Separate unrelated changes** — if `git status` shows files that were NOT part of the current task, do NOT include them
- If ALL changes are from the current conversation, proceed normally
- If there is a mix, clearly tell the user which files you will stage and which you will skip (and why)

### Step 3: Verify Before Committing
Check `.coding-friend/config.json` for `commit.verify` setting. If `verify: false`, skip this step.

1. Run the test suite — all tests must pass
2. Run linter if configured — no new warnings
3. Run build if applicable — must succeed

If any check fails, fix the issue FIRST. Do not commit broken code.

### Step 4: Stage Files
- Stage only files relevant to the current conversation's task
- Do NOT stage unrelated changes from other work
- Do NOT stage `.env`, credentials, or secrets
- Do NOT use `git add .` or `git add -A`

### Step 5: Write Commit Message
Follow conventional commits format:

```
<type>(<scope>): <subject>

<body - explain WHY, not WHAT>
```

Types: `feat`, `fix`, `refactor`, `test`, `docs`, `chore`, `style`, `perf`, `ci`

Rules:
- Subject line < 72 characters
- Body explains the motivation ("why"), not the mechanics ("what")
- If `$ARGUMENTS` is provided, use it as context for the message
- Reference issue numbers if applicable
- NEVER include AI/agent attribution (no "Co-Authored-By", "Generated by", "Claude", "Copilot", "AI-assisted", etc.)

### Step 6: Commit
```bash
git commit -m "<message>"
```

Show the commit result to the user.
